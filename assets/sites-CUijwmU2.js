import{V as I,_ as C}from"./VDataTableServer-43r6mKWS.js";import{_ as T}from"./AppSelect-BUMbAMKh.js";import{u as U}from"./global-qkxDnsNR.js";import{r as c,G as $,$ as b,a as N,o as P,f as E,e as s,ax as k,b as r,d as f,al as A,t as g,v as _,x as z,a1 as x,Q as G,R as L}from"./index-BS23A-8V.js";import{_ as O}from"./plugin-vue_export-helper-DlAUqK2U.js";import{V as R}from"./VCard-Bl_1nObG.js";import{V as j}from"./VCardText-Dupa1F-9.js";import{V as q}from"./VDivider-xe3kAmFZ.js";import"./VCheckboxBtn-BwMhMMIL.js";import"./VTextField-BBIv_7GE.js";import"./VImg-CEGqANsG.js";import"./forwardRefs-DWGaNmQL.js";import"./VChip-CDyJhLnZ.js";import"./VAvatar-C3Dh_S9l.js";import"./VList-F8ys7wTi.js";import"./VOverlay-Dn-Hev6S.js";import"./VMenu-DKlu_i5k.js";const M=m=>(G("data-v-420eac1a"),m=m(),L(),m),Q={class:"d-flex gap-4 align-center flex-wrap"},F={class:"d-flex align-center gap-2"},H=M(()=>f("span",null,"Show on page",-1)),J=["href"],K={__name:"sites",setup(m){U();const o=c([]),n=c([]),d=c(1),i=c(10),S=[{title:"Site Id",key:"id",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"description",key:"description",sortable:!0},{title:"Target URL",key:"target_url",sortable:!0},{title:"Action",key:"actions",sortable:!1}],u=c({}),y=e=>{!e||!e.sortBy.length?n.value=o.value:e.sortBy[0].key==="date"?n.value=o.value.toSorted((a,l)=>{const p=+new Date(a.created_at),v=+new Date(l.created_at);if(e.sortBy.length&&e.sortBy[0].order==="asc")return p>v;if(e.sortBy.length&&e.sortBy[0].order==="desc")return p<v}):n.value=o.value.toSorted((a,l)=>{if(e.sortBy.length&&e.sortBy[0].order==="asc")return a[e.sortBy[0].key]>l[e.sortBy[0].key];if(e.sortBy.length&&e.sortBy[0].order==="desc")return a[e.sortBy[0].key]<l[e.sortBy[0].key]})},w=e=>y(e),h=async()=>{const e=await k("https://tg-adsnet-api-proxy.goourl.ru/api/site/",{method:"GET"});o.value=e.toSorted((a,l)=>a.id<l.id),y()},V=async e=>{u.value[e]=1;try{await k(`https://tg-adsnet-api-proxy.goourl.ru/api/site/${e}/delete/`,{method:"DELETE"}),h()}catch(a){console.log(a)}finally{u.value[e]=!1}};$(async()=>{h()});const D=b(()=>!n.value||!n.value.length?[]:n.value.slice((d.value-1)*i.value,d.value*i.value)),B=b(()=>!o.value||!o.value.length?0:o.value.length);return(e,a)=>{const l=T,p=N("IconBtn"),v=C;return P(),E(R,null,{default:s(()=>[r(j,{class:"d-flex justify-space-between align-center flex-wrap gap-4"},{default:s(()=>[f("div",Q,[f("div",F,[H,r(l,{"model-value":i.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:1e3,title:"All"}],style:{"inline-size":"5.5rem"},"onUpdate:modelValue":a[0]||(a[0]=t=>i.value=parseInt(t,10))},null,8,["model-value"])]),r(A,{"prepend-icon":"tabler-plus",to:{name:"newsite"}},{default:s(()=>[g(" New site ")]),_:1})])]),_:1}),r(q),r(I,{"items-per-page":i.value,"onUpdate:itemsPerPage":a[2]||(a[2]=t=>i.value=t),page:d.value,"onUpdate:page":a[3]||(a[3]=t=>d.value=t),headers:S,items:D.value,"items-length":B.value,class:"text-no-wrap","onUpdate:options":w},{"item.id":s(({item:t})=>[g(_(t.id),1)]),"item.name":s(({item:t})=>[g(_(t.name),1)]),"item.description":s(({item:t})=>[g(_(t.description),1)]),"item.target_url":s(({item:t})=>[f("a",{href:t.target_url,class:z(["target-url__link",{"target-url__link--disabled":u.value[t.id]}])},_(t.target_url),11,J)]),"item.actions":s(({item:t})=>[r(p,{to:{name:"widgets",query:{id:t.id}},disabled:u.value[t.id]},{default:s(()=>[r(x,{icon:"tabler-eye"})]),_:2},1032,["to","disabled"]),r(p,{loading:u.value[t.id],disabled:u.value[t.id],onClick:W=>V(t.id)},{default:s(()=>[r(x,{icon:"tabler-trash"})]),_:2},1032,["loading","disabled","onClick"])]),bottom:s(()=>[r(v,{page:d.value,"onUpdate:page":a[1]||(a[1]=t=>d.value=t),"items-per-page":i.value,"total-items":B.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1})}}},ve=O(K,[["__scopeId","data-v-420eac1a"]]);export{ve as default};
