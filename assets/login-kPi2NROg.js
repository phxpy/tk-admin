import{r as m,i as C,j as A,a as F,o as S,c as N,b as s,e as o,d as u,m as e,H as V,v as b,t as _,ak as B,al as P,F as U,ax as j,as as p,aD as E}from"./index-mUf8a7pm.js";import{_ as L}from"./AppTextField-DtMBspkf.js";import{V as $}from"./VNodeRenderer-C1wJl_Ep.js";import{u as D}from"./useAbility-l4c2X-NH.js";import{a as y,V as w}from"./VRow-C46xLcHV.js";import{V as O}from"./VCard-BlgJAQ-u.js";import{V as v}from"./VCardText-BHogRFrq.js";import{V as z}from"./VForm-BNu_fGh7.js";import"./VTextField-XfMixXWU.js";import"./VImg-DQOj4B0x.js";import"./forwardRefs-DWGaNmQL.js";/* empty css              */import"./VAvatar-Cw3es8BT.js";const H=a=>a==null,I=a=>Array.isArray(a)&&a.length===0,k=a=>H(a)||I(a)||a===!1?"This field is required":!!String(a).trim().length||"This field is required",M={class:"auth-logo d-flex align-center gap-x-3"},W={class:"auth-title"},G={class:"text-h4 mb-1"},J={class:"text-capitalize"},K=u("p",{class:"mb-0"}," Please sign-in to your account and start the adventure ",-1),ue={__name:"login",setup(a){const d=m(!1),g=C(),x=A(),q=D(),c=m({username:void 0,password:void 0}),h=m(),n=m({username:"",password:""}),R=async()=>{try{const r=await j("https://tg-adsnet-api-proxy.goourl.ru/api/auth/token/",{method:"POST",body:{username:n.value.username,password:n.value.password},onResponseError({response:l}){c.value=l._data.errors}}),{access:t,refresh:f}=r,i=t?[{action:"manage",subject:"all"}]:"";p("userAbilityRules").value=i,q.update(i),p("accessToken").value=t,p("refreshToken").value=f,p("username").value=n.value.username,await E(()=>{x.replace(g.query.to?String(g.query.to):"/")})}catch(r){console.error(r)}},T=()=>{var r;(r=h.value)==null||r.validate().then(({valid:t})=>{t&&R()})};return(r,t)=>{const f=F("RouterLink"),i=L;return S(),N(U,null,[s(f,{to:"/"},{default:o(()=>[u("div",M,[s(e($),{nodes:e(V).app.logo},null,8,["nodes"]),u("h1",W,b(e(V).app.title),1)])]),_:1}),s(w,{class:"auth-wrapper"},{default:o(()=>[s(y,{cols:"12",md:"12",class:"auth-card-v2 d-flex align-center justify-center"},{default:o(()=>[s(O,{"max-width":460,class:"my-sm-16"},{default:o(()=>[s(v,null,{default:o(()=>[u("h4",G,[_(" Welcome to "),u("span",J,b(e(V).app.title),1),_("! 👋🏻 ")]),K]),_:1}),s(v,null,{default:o(()=>[s(e(z),{ref_key:"refVForm",ref:h,onSubmit:B(T,["prevent"])},{default:o(()=>[s(w,null,{default:o(()=>[s(y,{cols:"12"},{default:o(()=>[s(i,{modelValue:e(n).username,"onUpdate:modelValue":t[0]||(t[0]=l=>e(n).username=l),label:"Username",type:"text",autofocus:"",rules:["requiredValidator"in r?r.requiredValidator:e(k)],"error-messages":e(c).username},null,8,["modelValue","rules","error-messages"])]),_:1}),s(y,{cols:"12"},{default:o(()=>[s(i,{modelValue:e(n).password,"onUpdate:modelValue":t[1]||(t[1]=l=>e(n).password=l),label:"Password",rules:["requiredValidator"in r?r.requiredValidator:e(k)],type:e(d)?"text":"password","error-messages":e(c).password,"append-inner-icon":e(d)?"tabler-eye-off":"tabler-eye","onClick:appendInner":t[2]||(t[2]=l=>d.value=!e(d))},null,8,["modelValue","rules","type","error-messages","append-inner-icon"]),s(P,{block:"",type:"submit",class:"mt-6"},{default:o(()=>[_(" Login ")]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),_:1})]),_:1})]),_:1})],64)}}};export{ue as default};
