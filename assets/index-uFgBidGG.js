import{V as U,_ as E}from"./VDataTableServer-Dz50i3bZ.js";import{_ as O}from"./AppSelect-DCmqlFUf.js";import{u as G}from"./global-CoD641hM.js";import{r as m,G as q,$ as V,a as M,o as C,f as k,e as l,ax as h,b as o,d as w,al as j,t as p,v,m as z,a1 as y,y as D,Q as F,R as Q}from"./index-CWraBpLz.js";import{_ as R}from"./plugin-vue_export-helper-DlAUqK2U.js";import{V as H}from"./VCard-DZoQsszH.js";import{V as J}from"./VCardText-DiSglReM.js";import{V as K}from"./VDivider-Bq4qZXJE.js";import"./VCheckboxBtn-BFg9wEe8.js";import"./VTextField-DwMYOT3R.js";import"./VImg-M8Sh9rRd.js";import"./forwardRefs-DWGaNmQL.js";import"./VChip-C13b0Um0.js";import"./VAvatar-l8SG5SE9.js";import"./VList-6yLAQCTI.js";import"./VOverlay-CN531U9F.js";import"./VMenu-BphMWXre.js";const W=f=>(F("data-v-10963dcf"),f=f(),Q(),f),X={class:"d-flex gap-4 align-center flex-wrap"},Y={class:"d-flex align-center gap-2"},Z=W(()=>w("span",null,"Show on page",-1)),ee={__name:"index",setup(f){const I=G(),i=m([]),c=m([]),g=m(1),u=m(10),$=[{title:"CAMPAING ID",key:"id",sortable:!0},{title:"Status",key:"status",sortable:!0},{title:"Name",key:"title",sortable:!0},{title:"budget",key:"total_budget",sortable:!0},{title:"Date",key:"date",sortable:!0},{title:"Total spend",key:"spend_budget",sortable:!0},{title:"Action",key:"actions",sortable:!1}],r=m({}),s=m({}),B=t=>{!t||!t.sortBy.length?c.value=i.value:t.sortBy[0].key==="date"?c.value=i.value.toSorted((a,n)=>{const d=+new Date(a.created_at),b=+new Date(n.created_at);return t.sortBy.length&&t.sortBy[0].order==="asc"?d>b?1:-1:t.sortBy.length&&t.sortBy[0].order==="desc"?d<b?1:-1:0}):c.value=i.value.toSorted((a,n)=>t.sortBy.length&&t.sortBy[0].order==="asc"?a[t.sortBy[0].key]>n[t.sortBy[0].key]?1:-1:t.sortBy.length&&t.sortBy[0].order==="desc"?a[t.sortBy[0].key]<n[t.sortBy[0].key]?1:-1:0)},T=t=>B(t),_=async()=>{const t=await h("https://tg-adsnet-api-proxy.goourl.ru/api/campaign/",{method:"GET"});i.value=t.toSorted((a,n)=>n.id-a.id),B()},P=async t=>{r.value[t]=!0;try{await h(`https://tg-adsnet-api-proxy.goourl.ru/api/campaign/${t}/delete/`,{method:"DELETE"}),_()}catch(a){console.log(a)}finally{r.value[t]=!1}},N=async t=>{try{s.value[t]=!0,await h(`https://tg-adsnet-api-proxy.goourl.ru/api/campaign/${t}/start/`,{method:"POST"}),_()}catch(a){console.log(a)}finally{s.value[t]=!1}},L=async t=>{try{s.value[t]=!0,await h(`https://tg-adsnet-api-proxy.goourl.ru/api/campaign/${t}/stop/`,{method:"POST"}),_()}catch(a){console.log(a)}finally{s.value[t]=!1}};q(async()=>{_()});const A=V(()=>!c.value||!c.value.length?[]:c.value.slice((g.value-1)*u.value,g.value*u.value)),x=V(()=>!i.value||!i.value.length?0:i.value.length);return(t,a)=>{const n=O,d=M("IconBtn"),b=E;return C(),k(H,null,{default:l(()=>[o(J,{class:"d-flex justify-space-between align-center flex-wrap gap-4"},{default:l(()=>[w("div",X,[w("div",Y,[Z,o(n,{"model-value":u.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:1e3,title:"All"}],style:{"inline-size":"5.5rem"},"onUpdate:modelValue":a[0]||(a[0]=e=>u.value=parseInt(e,10))},null,8,["model-value"])]),o(j,{"prepend-icon":"tabler-plus",to:{name:"newcampaign"}},{default:l(()=>[p(" New campaing ")]),_:1})])]),_:1}),o(K),o(U,{"items-per-page":u.value,"onUpdate:itemsPerPage":a[2]||(a[2]=e=>u.value=e),page:g.value,"onUpdate:page":a[3]||(a[3]=e=>g.value=e),headers:$,items:A.value,"items-length":x.value,class:"text-no-wrap","onUpdate:options":T},{"item.id":l(({item:e})=>[p(v(e.id),1)]),"item.status":l(({item:e})=>[p(v(e.status),1)]),"item.title":l(({item:e})=>[p(v(e.title),1)]),"item.total_budget":l(({item:e})=>[p(v(e.total_budget),1)]),"item.date":l(({item:e})=>[p(v(z(I).timeFormatter.format(new Date(e.created_at))),1)]),"item.spend_budget":l(({item:e})=>[p(v(e.spend_budget),1)]),"item.actions":l(({item:e})=>[e.status.toLowerCase()!=="started"?(C(),k(d,{key:0,disabled:r.value[e.id]||s.value[e.id]||e.status.toLowerCase()==="draft"||e.status.toLowerCase()==="moderating",loading:s.value[e.id],onClick:S=>N(e.id)},{default:l(()=>[o(y,{icon:"tabler-play"})]),_:2},1032,["disabled","loading","onClick"])):D("",!0),e.status.toLowerCase()==="started"?(C(),k(d,{key:1,disabled:r.value[e.id],loading:s.value[e.id],onClick:S=>L(e.id)},{default:l(()=>[o(y,{icon:"tabler-pause"})]),_:2},1032,["disabled","loading","onClick"])):D("",!0),o(d,{to:{name:"creatives",query:{id:e.id}},disabled:r.value[e.id]||s.value[e.id]},{default:l(()=>[o(y,{icon:"tabler-eye"})]),_:2},1032,["to","disabled"]),o(d,{to:{name:"editcampaign",query:{id:e.id}},disabled:r.value[e.id]||s.value[e.id]},{default:l(()=>[o(y,{icon:"tabler-edit"})]),_:2},1032,["to","disabled"]),o(d,{loading:r.value[e.id],disabled:r.value[e.id]||s.value[e.id]||e.status.toLowerCase()!=="draft",onClick:S=>P(e.id)},{default:l(()=>[o(y,{icon:"tabler-trash"})]),_:2},1032,["loading","disabled","onClick"])]),bottom:l(()=>[o(b,{page:g.value,"onUpdate:page":a[1]||(a[1]=e=>g.value=e),"items-per-page":u.value,"total-items":x.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1})}}},_e=R(ee,[["__scopeId","data-v-10963dcf"]]);export{_e as default};
