import{V as se,_ as ue}from"./VDataTableServer-Dz50i3bZ.js";import{_ as ne}from"./AppSelect-DCmqlFUf.js";import{l as z,_ as re}from"./lodash-D9ya5ZLD.js";import{ay as de,r as v,G as ie,$ as b,w as $,o as g,c as h,b as l,e as o,F as ve,ax as Q,t as d,y as w,az as me,v as n,d as i,Q as ce,R as pe}from"./index-CWraBpLz.js";import{_ as fe}from"./plugin-vue_export-helper-DlAUqK2U.js";import{V as O,a as D}from"./VRow-kUaHlpkb.js";import{V as x}from"./VCard-DZoQsszH.js";import{V as B}from"./VCardText-DiSglReM.js";import{V as E}from"./VCheckbox-D4tkNCcQ.js";import{V as ge}from"./VDivider-Bq4qZXJE.js";import"./VCheckboxBtn-BFg9wEe8.js";import"./VTextField-DwMYOT3R.js";import"./VImg-M8Sh9rRd.js";import"./forwardRefs-DWGaNmQL.js";import"./VChip-C13b0Um0.js";import"./VAvatar-l8SG5SE9.js";import"./VList-6yLAQCTI.js";import"./VOverlay-CN531U9F.js";import"./VMenu-BphMWXre.js";import"./commonjsHelpers-Cpj98o6Y.js";/* empty css              */const F=H=>(ce("data-v-67cd97a1"),H=H(),pe(),H),he=F(()=>i("svg",{viewBox:"0 0 50 50",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M32.96 25 48.325 9.722c2.235-2.222 2.235-5.555 0-7.778C47.486.834 46.089 0 44.693 0c-1.397 0-2.794.556-3.91 1.667L25.14 17.222 9.777 1.944c-2.235-2.222-5.866-2.222-7.822 0A4.851 4.851 0 0 0 0 5.834C0 7.5.559 8.61 1.676 9.721L17.039 25 1.676 40.278C.838 41.388 0 42.778 0 44.444c0 1.39.559 2.778 1.676 3.89C2.793 49.443 4.19 50 5.586 50c1.397 0 2.794-.556 3.911-1.667L24.86 33.056l15.364 15.277c2.234 2.223 5.865 2.223 7.82 0 2.235-2.222 2.235-5.833 0-7.777L32.962 25Z"})],-1)),_e=F(()=>i("svg",{viewBox:"0 0 50 50",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M32.96 25 48.325 9.722c2.235-2.222 2.235-5.555 0-7.778C47.486.834 46.089 0 44.693 0c-1.397 0-2.794.556-3.91 1.667L25.14 17.222 9.777 1.944c-2.235-2.222-5.866-2.222-7.822 0A4.851 4.851 0 0 0 0 5.834C0 7.5.559 8.61 1.676 9.721L17.039 25 1.676 40.278C.838 41.388 0 42.778 0 44.444c0 1.39.559 2.778 1.676 3.89C2.793 49.443 4.19 50 5.586 50c1.397 0 2.794-.556 3.911-1.667L24.86 33.056l15.364 15.277c2.234 2.223 5.865 2.223 7.82 0 2.235-2.222 2.235-5.833 0-7.777L32.962 25Z"})],-1)),we=F(()=>i("svg",{viewBox:"0 0 50 50",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M32.96 25 48.325 9.722c2.235-2.222 2.235-5.555 0-7.778C47.486.834 46.089 0 44.693 0c-1.397 0-2.794.556-3.91 1.667L25.14 17.222 9.777 1.944c-2.235-2.222-5.866-2.222-7.822 0A4.851 4.851 0 0 0 0 5.834C0 7.5.559 8.61 1.676 9.721L17.039 25 1.676 40.278C.838 41.388 0 42.778 0 44.444c0 1.39.559 2.778 1.676 3.89C2.793 49.443 4.19 50 5.586 50c1.397 0 2.794-.556 3.911-1.667L24.86 33.056l15.364 15.277c2.234 2.223 5.865 2.223 7.82 0 2.235-2.222 2.235-5.833 0-7.777L32.962 25Z"})],-1)),ye=F(()=>i("svg",{viewBox:"0 0 50 50",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M32.96 25 48.325 9.722c2.235-2.222 2.235-5.555 0-7.778C47.486.834 46.089 0 44.693 0c-1.397 0-2.794.556-3.91 1.667L25.14 17.222 9.777 1.944c-2.235-2.222-5.866-2.222-7.822 0A4.851 4.851 0 0 0 0 5.834C0 7.5.559 8.61 1.676 9.721L17.039 25 1.676 40.278C.838 41.388 0 42.778 0 44.444c0 1.39.559 2.778 1.676 3.89C2.793 49.443 4.19 50 5.586 50c1.397 0 2.794-.556 3.911-1.667L24.86 33.056l15.364 15.277c2.234 2.223 5.865 2.223 7.82 0 2.235-2.222 2.235-5.833 0-7.777L32.962 25Z"})],-1)),Ie={class:"table-total-bottom"},Ve={key:0},Se={key:1},ke={key:2},be={key:3},Ce={key:4},De={__name:"adstats",setup(H){const y=de(),P=new Date,G=new Date(P);G.setDate(P.getDate()-7);const J=G.toISOString().split("T")[0],K=P.toISOString().split("T")[0],T=v(1),L=v(10),p=v(`${J} to ${K}`),f=v([]),I=v([]),U=v([]),R=v([]),s=v({eventDateShown:!0,campIdShown:!1,creativeIdShown:!1,geoIdShown:!1,deviceIdShown:!1}),m=v([]),_=v([]),V=v([]),S=v([]),A=v([]),k=v({eventDateTotalHeader:"",campaignTotalHeader:"",creativeTotalHeader:"",geoTotalHeader:"",platformTotalHeader:""}),X=a=>{M(a)},M=a=>{!a||!a.sortBy.length?U.value=f.value:a.sortBy[0].key==="eventDate"?U.value=f.value.toSorted((e,c)=>{const u=+new Date(e.eventDate),r=+new Date(c.eventDate);return a.sortBy.length&&a.sortBy[0].order==="asc"?u>r?1:-1:a.sortBy.length&&a.sortBy[0].order==="desc"?u<r?1:-1:0}):U.value=f.value.toSorted((e,c)=>{const u=parseFloat(e[a.sortBy[0].key]),r=parseFloat(c[a.sortBy[0].key]);return a.sortBy.length&&a.sortBy[0].order==="asc"?u>r?1:-1:a.sortBy.length&&a.sortBy[0].order==="desc"?u<r?1:-1:0})},C=async()=>{const a=[];f.value=[],I.value={},j.value&&a.push(`date_to=${j.value}`),q.value&&a.push(`date_from=${q.value}`),m.value.length&&m.value.forEach(u=>{a.push(`camp_id=${u}`)}),_.value.length&&_.value.forEach(u=>{a.push(`creative_id=${u}`)});const e=[];if(V.value.length){let u="";for(const r in y.countries)V.value.forEach(t=>{t===y.countries[r]&&(u=r)});e.push(u),e.forEach(r=>{a.push(`geo=${r}`)})}else a.push("geo=all");for(const u in s.value)s.value[u]&&a.push(`group_by=${u.slice(0,-5)}`);S.value.length?S.value.forEach(u=>{a.push(`platform=${u}`)}):a.push("platform=all"),c(a);async function c(u){const r=await Q(`https://tg-adsnet-api-proxy.goourl.ru/api/stats/advertiser/${u.length?`?${u.join("&")}`:""}`,{method:"GET"});f.value.push(...r.data),f.value=z.uniqWith(f.value,z.isEqual),I.value=r.total,M()}},Y=async()=>{const a=await Q("https://tg-adsnet-api-proxy.goourl.ru/api/campaign/ids/",{method:"GET"});R.value=a},N=()=>{A.value=[...s.value.eventDateShown?[{title:"Date",key:"eventDate",sortable:!0}]:[],...s.value.campIdShown?[{title:"Campaign",key:"campId",sortable:!0}]:[],...s.value.creativeIdShown?[{title:"Creative",key:"creativeId",sortable:!0}]:[],...s.value.geoIdShown?[{title:"GEO",key:"geoId",sortable:!0}]:[],...s.value.deviceIdShown?[{title:"Platform",key:"deviceId",sortable:!0}]:[],{title:"Views",key:"sum_views",sortable:!0},{title:"Hits",key:"sum_hits",sortable:!0},{title:"CTR",key:"ctr",sortable:!0},{title:"Actions",key:"sum_action",sortable:!0},{title:"CPC",key:"cpc",sortable:!0},{title:"Advert",key:"sum_advert",sortable:!0}]},Z=()=>{for(const a in k.value)k.value[a]="";for(let a=0;a<Object.keys(s.value).length;a++){const e=A.value[a];if(e.key){k.value[`${e.key}TotalHeader`]="Total";break}}};ie(()=>{Y(),N(),C(),Z()});const ee=b(()=>{const a=[];for(const e in y.platforms)y.platforms[e]!=="all"&&a.push(y.platforms[e]);return a}),te=b(()=>{const a=[];for(const e in y.countries)y.countries[e]!=="all"&&a.push(y.countries[e]);return a}),ae=b(()=>U.value.slice((T.value-1)*L.value,T.value*L.value)),W=b(()=>f.value&&f.value.length?f.value.length:0),j=b(()=>p.value&&p.value.split(" to ")[1]?p.value.split(" to ")[1]:""),q=b(()=>p.value&&p.value.split(" to ")[0]?p.value.split(" to ")[0]:""),le=b(()=>R.value.map(a=>a.id)),oe=b(()=>{if(m.value.length){let a=[];const e=[];return m.value.forEach(c=>{e.push(R.value.find(u=>u.id===c))}),e.forEach(c=>{a.push(...c.creatives)}),a}else return[]});return $(p,()=>{C(),p.value},{deep:!0}),$(m,()=>{C(),m.value,m.value.length||(_.value=[])},{deep:!0}),$(_,()=>{C(),_.value},{deep:!0}),$(V,()=>{C(),V.value},{deep:!0}),$(S,()=>{C(),S.value},{deep:!0}),$(s,()=>{N(),C(),Z()},{deep:!0}),(a,e)=>{const c=re,u=ne,r=ue;return g(),h(ve,null,[l(O,null,{default:o(()=>[l(D,{cols:"4",md:"4"},{default:o(()=>[l(x,{title:"Date Range"},{default:o(()=>[l(B,null,{default:o(()=>[l(c,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=t=>p.value=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(D,{cols:"2",md:"2"},{default:o(()=>[l(x,{title:"Campaign"},{default:o(()=>[l(B,{class:"stats__multiselect"},{default:o(()=>[l(u,{modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=t=>m.value=t),items:le.value,multiple:"",placeholder:"Campaigns"},null,8,["modelValue","items"]),m.value.length?(g(),h("button",{key:0,class:"stats__multiselect-btn",onClick:e[2]||(e[2]=t=>m.value=[])},[he,d(" Reset ")])):w("",!0)]),_:1})]),_:1})]),_:1}),l(D,{cols:"2",md:"2"},{default:o(()=>[l(x,{title:"Creative"},{default:o(()=>[l(B,{class:"stats__multiselect"},{default:o(()=>[l(u,{modelValue:_.value,"onUpdate:modelValue":e[3]||(e[3]=t=>_.value=t),items:oe.value,multiple:"",placeholder:"Creatives"},null,8,["modelValue","items"]),_.value.length?(g(),h("button",{key:0,class:"stats__multiselect-btn",onClick:e[4]||(e[4]=t=>_.value=[])},[_e,d(" Reset ")])):w("",!0)]),_:1})]),_:1})]),_:1}),l(D,{cols:"2",md:"2"},{default:o(()=>[l(x,{title:"GEO"},{default:o(()=>[l(B,{class:"stats__multiselect"},{default:o(()=>[l(u,{modelValue:V.value,"onUpdate:modelValue":e[5]||(e[5]=t=>V.value=t),items:te.value,multiple:"",placeholder:"GEO",fixed:""},null,8,["modelValue","items"]),V.value.length?(g(),h("button",{key:0,class:"stats__multiselect-btn",onClick:e[6]||(e[6]=t=>V.value=[])},[we,d(" Reset ")])):w("",!0)]),_:1})]),_:1})]),_:1}),l(D,{cols:"2",md:"2"},{default:o(()=>[l(x,{title:"Platform"},{default:o(()=>[l(B,{class:"stats__multiselect"},{default:o(()=>[l(u,{modelValue:S.value,"onUpdate:modelValue":e[7]||(e[7]=t=>S.value=t),items:ee.value,multiple:"",placeholder:"Platforms"},null,8,["modelValue","items"]),S.value.length?(g(),h("button",{key:0,class:"stats__multiselect-btn",onClick:e[8]||(e[8]=t=>S.value=[])},[ye,d(" Reset ")])):w("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),l(O,null,{default:o(()=>[l(D,{cols:"12"},{default:o(()=>[l(x,null,{default:o(()=>[l(B,{class:"d-flex"},{default:o(()=>[l(E,{modelValue:s.value.eventDateShown,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.eventDateShown=t),label:"Date"},null,8,["modelValue"]),l(E,{modelValue:s.value.campIdShown,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.campIdShown=t),label:"Campaign"},null,8,["modelValue"]),l(E,{modelValue:s.value.creativeIdShown,"onUpdate:modelValue":e[11]||(e[11]=t=>s.value.creativeIdShown=t),label:"Creative"},null,8,["modelValue"]),l(E,{modelValue:s.value.geoIdShown,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.geoIdShown=t),label:"GEO"},null,8,["modelValue"]),l(E,{modelValue:s.value.deviceIdShown,"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.deviceIdShown=t),label:"Platform"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(O,null,{default:o(()=>[l(D,{cols:"12"},{default:o(()=>[l(x,null,{default:o(()=>[l(ge),l(se,{"items-per-page":L.value,"onUpdate:itemsPerPage":e[15]||(e[15]=t=>L.value=t),page:T.value,"onUpdate:page":e[16]||(e[16]=t=>T.value=t),headers:A.value,items:ae.value,"items-length":W.value,class:"text-no-wrap","onUpdate:options":X},me({"item.sum_views":o(({item:t})=>[d(n(t.sum_views),1)]),"item.sum_hits":o(({item:t})=>[d(n(t.sum_hits),1)]),"item.ctr":o(({item:t})=>[d(n(t.ctr),1)]),"item.sum_action":o(({item:t})=>[d(n(t.sum_action),1)]),"item.cpc":o(({item:t})=>[d(n(t.cpc),1)]),"item.sum_advert":o(({item:t})=>[d(n(t.sum_advert),1)]),"body.append":o(()=>[i("tr",Ie,[s.value.eventDateShown?(g(),h("td",Ve,n(k.value.eventDateTotalHeader),1)):w("",!0),s.value.campIdShown?(g(),h("td",Se,n(k.value.campaignTotalHeader),1)):w("",!0),s.value.creativeIdShown?(g(),h("td",ke,n(k.value.creativeTotalHeader),1)):w("",!0),s.value.geoIdShown?(g(),h("td",be,n(k.value.geoTotalHeader),1)):w("",!0),s.value.deviceIdShown?(g(),h("td",Ce,n(k.value.platformTotalHeader),1)):w("",!0),i("td",null,n(I.value.total_views),1),i("td",null,n(I.value.total_hits),1),i("td",null,n(parseFloat(I.value.total_ctr).toFixed(2)),1),i("td",null,n(I.value.total_actions),1),i("td",null,n(parseFloat(I.value.total_cpc).toFixed(2)),1),i("td",null,n(parseFloat(I.value.total_advert).toFixed(2)),1)])]),bottom:o(()=>[l(r,{page:T.value,"onUpdate:page":e[14]||(e[14]=t=>T.value=t),"items-per-page":L.value,"total-items":W.value},null,8,["page","items-per-page","total-items"])]),_:2},[s.value.eventDateShown?{name:"item.eventDate",fn:o(({item:t})=>[d(n(t.eventDate),1)]),key:"0"}:void 0,s.value.campIdShown?{name:"item.campId",fn:o(({item:t})=>[d(n(t.campId),1)]),key:"1"}:void 0,s.value.creativeIdShown?{name:"item.creativeId",fn:o(({item:t})=>[d(n(t.creativeId),1)]),key:"2"}:void 0,s.value.geoIdShown?{name:"item.geoId",fn:o(({item:t})=>[d(n(t.geoId),1)]),key:"3"}:void 0,s.value.deviceIdShown?{name:"item.deviceId",fn:o(({item:t})=>[d(n(t.deviceId),1)]),key:"4"}:void 0]),1032,["items-per-page","page","headers","items","items-length"])]),_:1})]),_:1})]),_:1})],64)}}},Qe=fe(De,[["__scopeId","data-v-67cd97a1"]]);export{Qe as default};
