import{V as I,_ as C}from"./VDataTableServer-BAH2BFlR.js";import{_ as T}from"./AppSelect-D2iDdZ6c.js";import{u as U}from"./global-Drrj5Hn-.js";import{r as p,G as $,$ as b,a as N,o as P,f as E,e as s,ax as k,b as l,d as f,al as A,t as g,v as _,x as z,a1 as x,Q as G,R as L}from"./index-CYp9PX9m.js";import{_ as O}from"./plugin-vue_export-helper-DlAUqK2U.js";import{V as R}from"./VCard-B2fiEv2A.js";import{V as j}from"./VCardText-14BuuPK9.js";import{V as q}from"./VDivider-IjSj_J1M.js";import"./VCheckboxBtn-eA-y8QCf.js";import"./VTextField-DvVMCfta.js";import"./VImg-BdqCSq8N.js";import"./forwardRefs-DWGaNmQL.js";import"./VChip-nVK1MyrQ.js";import"./VAvatar-DqkvVaPE.js";import"./VList-C3rNrzYf.js";import"./VOverlay-CsVXx32O.js";import"./VMenu-CMPdzmr_.js";const M=m=>(G("data-v-c14787cc"),m=m(),L(),m),Q={class:"d-flex gap-4 align-center flex-wrap"},F={class:"d-flex align-center gap-2"},H=M(()=>f("span",null,"Show on page",-1)),J=["href"],K={__name:"sites",setup(m){U();const r=p([]),i=p([]),n=p(1),o=p(10),S=[{title:"Site Id",key:"id",sortable:!0},{title:"Name",key:"name",sortable:!0},{title:"description",key:"description",sortable:!0},{title:"Target URL",key:"target_url",sortable:!0},{title:"Action",key:"actions",sortable:!1}],d=p({}),y=e=>{!e||!e.sortBy.length?i.value=r.value:e.sortBy[0].key==="date"?i.value=r.value.toSorted((a,u)=>{const c=+new Date(a.created_at),v=+new Date(u.created_at);if(e.sortBy.length&&e.sortBy[0].order==="asc")return c>v;if(e.sortBy.length&&e.sortBy[0].order==="desc")return c<v}):i.value=r.value.toSorted((a,u)=>{if(e.sortBy.length&&e.sortBy[0].order==="asc")return a[e.sortBy[0].key]>u[e.sortBy[0].key];if(e.sortBy.length&&e.sortBy[0].order==="desc")return a[e.sortBy[0].key]<u[e.sortBy[0].key]})},w=e=>y(e),h=async()=>{const e=await k("https://tg-adsnet-api-proxy.goourl.ru/api/site/",{method:"GET"});r.value=e,y()},V=async e=>{d.value[e]=1;try{await k(`https://tg-adsnet-api-proxy.goourl.ru/api/site/${e}/delete/`,{method:"DELETE"}),h()}catch(a){console.log(a)}finally{d.value[e]=!1}};$(async()=>{h()});const D=b(()=>!i.value||!i.value.length?[]:i.value.slice((n.value-1)*o.value,n.value*o.value)),B=b(()=>!r.value||!r.value.length?0:r.value.length);return(e,a)=>{const u=T,c=N("IconBtn"),v=C;return P(),E(R,null,{default:s(()=>[l(j,{class:"d-flex justify-space-between align-center flex-wrap gap-4"},{default:s(()=>[f("div",Q,[f("div",F,[H,l(u,{"model-value":o.value,items:[{value:10,title:"10"},{value:25,title:"25"},{value:50,title:"50"},{value:100,title:"100"},{value:1e3,title:"All"}],style:{"inline-size":"5.5rem"},"onUpdate:modelValue":a[0]||(a[0]=t=>o.value=parseInt(t,10))},null,8,["model-value"])]),l(A,{"prepend-icon":"tabler-plus",to:{name:"newsite"}},{default:s(()=>[g(" New site ")]),_:1})])]),_:1}),l(q),l(I,{"items-per-page":o.value,"onUpdate:itemsPerPage":a[2]||(a[2]=t=>o.value=t),page:n.value,"onUpdate:page":a[3]||(a[3]=t=>n.value=t),headers:S,items:D.value,"items-length":B.value,class:"text-no-wrap","onUpdate:options":w},{"item.id":s(({item:t})=>[g(_(t.id),1)]),"item.name":s(({item:t})=>[g(_(t.name),1)]),"item.description":s(({item:t})=>[g(_(t.description),1)]),"item.target_url":s(({item:t})=>[f("a",{href:t.target_url,class:z(["target-url__link",{"target-url__link--disabled":d.value[t.id]}])},_(t.target_url),11,J)]),"item.actions":s(({item:t})=>[l(c,{to:{name:"widgets",query:{id:t.id}},disabled:d.value[t.id]},{default:s(()=>[l(x,{icon:"tabler-eye"})]),_:2},1032,["to","disabled"]),l(c,{loading:d.value[t.id],disabled:d.value[t.id],onClick:W=>V(t.id)},{default:s(()=>[l(x,{icon:"tabler-trash"})]),_:2},1032,["loading","disabled","onClick"])]),bottom:s(()=>[l(v,{page:n.value,"onUpdate:page":a[1]||(a[1]=t=>n.value=t),"items-per-page":o.value,"total-items":B.value},null,8,["page","items-per-page","total-items"])]),_:1},8,["items-per-page","page","items","items-length"])]),_:1})}}},ve=O(K,[["__scopeId","data-v-c14787cc"]]);export{ve as default};
